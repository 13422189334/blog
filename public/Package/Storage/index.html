<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Storage | 繁华中自律，落魄中自愈</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="stylesheet" href="https://at.alicdn.com/t/font_3077305_pt8umhrn4k9.css">
    <link rel="javascript" href="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js">
    <link rel="stylesheet" href="//at.alicdn.com/t/font_3114978_qe0b39no76.css">
    <link rel="manifest" href="/manifest.webmanifest" crossorigin="use-credentials">
    <meta name="description" content="Just playing around">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <meta name="theme-color" content="#46bd87">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    
    <link rel="preload" href="/assets/css/0.styles.038b456f.css" as="style"><link rel="preload" href="/assets/js/app.e55f4abd.js" as="script"><link rel="preload" href="/assets/js/3.bc0c2498.js" as="script"><link rel="preload" href="/assets/js/60.071b43a3.js" as="script"><link rel="preload" href="/assets/js/22.ced87b4d.js" as="script"><link rel="preload" href="/assets/js/9.e2c20ecd.js" as="script"><link rel="prefetch" href="/assets/js/10.73b02319.js"><link rel="prefetch" href="/assets/js/11.771a938e.js"><link rel="prefetch" href="/assets/js/12.1f060336.js"><link rel="prefetch" href="/assets/js/13.8f8233fa.js"><link rel="prefetch" href="/assets/js/14.fd674787.js"><link rel="prefetch" href="/assets/js/15.6e628831.js"><link rel="prefetch" href="/assets/js/16.6274fae1.js"><link rel="prefetch" href="/assets/js/17.09e690d1.js"><link rel="prefetch" href="/assets/js/18.cebb8b51.js"><link rel="prefetch" href="/assets/js/19.27e1fe6e.js"><link rel="prefetch" href="/assets/js/20.004b2a23.js"><link rel="prefetch" href="/assets/js/21.a98f0ac8.js"><link rel="prefetch" href="/assets/js/23.2bb09f42.js"><link rel="prefetch" href="/assets/js/24.95e99013.js"><link rel="prefetch" href="/assets/js/25.2c9b6391.js"><link rel="prefetch" href="/assets/js/26.8eb9cf48.js"><link rel="prefetch" href="/assets/js/27.3f10de59.js"><link rel="prefetch" href="/assets/js/28.e57ccbac.js"><link rel="prefetch" href="/assets/js/29.cd5dd0f8.js"><link rel="prefetch" href="/assets/js/30.cc6ca8c7.js"><link rel="prefetch" href="/assets/js/31.9eca7298.js"><link rel="prefetch" href="/assets/js/32.0849a8db.js"><link rel="prefetch" href="/assets/js/33.4ac13cf6.js"><link rel="prefetch" href="/assets/js/34.5c6bcbf5.js"><link rel="prefetch" href="/assets/js/35.5b75aee0.js"><link rel="prefetch" href="/assets/js/36.35060f28.js"><link rel="prefetch" href="/assets/js/37.837d3424.js"><link rel="prefetch" href="/assets/js/38.30499463.js"><link rel="prefetch" href="/assets/js/39.1f0fa834.js"><link rel="prefetch" href="/assets/js/4.f32d5f99.js"><link rel="prefetch" href="/assets/js/40.5c697fed.js"><link rel="prefetch" href="/assets/js/41.14276157.js"><link rel="prefetch" href="/assets/js/42.e6dd56b2.js"><link rel="prefetch" href="/assets/js/43.6805bc2f.js"><link rel="prefetch" href="/assets/js/44.2ac70d88.js"><link rel="prefetch" href="/assets/js/45.2b778f9c.js"><link rel="prefetch" href="/assets/js/46.a48f04e4.js"><link rel="prefetch" href="/assets/js/47.883731db.js"><link rel="prefetch" href="/assets/js/48.29bcb66a.js"><link rel="prefetch" href="/assets/js/49.1ebbfafb.js"><link rel="prefetch" href="/assets/js/5.b062ed64.js"><link rel="prefetch" href="/assets/js/50.e0614fce.js"><link rel="prefetch" href="/assets/js/51.5dd3e7ed.js"><link rel="prefetch" href="/assets/js/52.82930a81.js"><link rel="prefetch" href="/assets/js/53.55e7a459.js"><link rel="prefetch" href="/assets/js/54.65434bea.js"><link rel="prefetch" href="/assets/js/55.2b21562c.js"><link rel="prefetch" href="/assets/js/56.edd30b0c.js"><link rel="prefetch" href="/assets/js/57.6ca491a1.js"><link rel="prefetch" href="/assets/js/58.a53bc641.js"><link rel="prefetch" href="/assets/js/59.cacf9050.js"><link rel="prefetch" href="/assets/js/6.d9c84a16.js"><link rel="prefetch" href="/assets/js/61.1a66292c.js"><link rel="prefetch" href="/assets/js/62.dd0b7a66.js"><link rel="prefetch" href="/assets/js/63.5d515649.js"><link rel="prefetch" href="/assets/js/64.b3d5da93.js"><link rel="prefetch" href="/assets/js/65.0788db0c.js"><link rel="prefetch" href="/assets/js/66.4580a7fb.js"><link rel="prefetch" href="/assets/js/67.264f5b0a.js"><link rel="prefetch" href="/assets/js/68.7a960a93.js"><link rel="prefetch" href="/assets/js/69.07e188e3.js"><link rel="prefetch" href="/assets/js/7.7526e2b2.js"><link rel="prefetch" href="/assets/js/70.7a42c352.js"><link rel="prefetch" href="/assets/js/71.30096cc6.js"><link rel="prefetch" href="/assets/js/72.f15d8bca.js"><link rel="prefetch" href="/assets/js/73.b65622cd.js"><link rel="prefetch" href="/assets/js/74.b648b78e.js"><link rel="prefetch" href="/assets/js/75.f1d52c0f.js"><link rel="prefetch" href="/assets/js/76.3c875b4f.js"><link rel="prefetch" href="/assets/js/77.6bd17ae9.js"><link rel="prefetch" href="/assets/js/78.f315784d.js"><link rel="prefetch" href="/assets/js/79.87db797f.js"><link rel="prefetch" href="/assets/js/8.97c9f6f1.js"><link rel="prefetch" href="/assets/js/80.17fcdc37.js"><link rel="prefetch" href="/assets/js/vendors~docsearch.c750476e.js">
    <link rel="stylesheet" href="/assets/css/0.styles.038b456f.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container no-sidebar have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.jpg" alt="繁华中自律，落魄中自愈" class="logo"> <span class="site-name can-hide">繁华中自律，落魄中自愈</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/FrontEnd/" class="nav-link">前端知识库</a></div><div class="nav-item"><a href="/BackEnd/" class="nav-link">后端知识库</a></div><div class="nav-item"><a href="/DesignPattern/" class="nav-link">设计模式</a></div><div class="nav-item"><a href="/Algorithm/Dichotomy/" class="nav-link">常用算法</a></div><div class="nav-item"><a href="/Git/" class="nav-link">Git</a></div><div class="nav-item"><a href="/Server/" class="nav-link">服务器</a></div><div class="nav-item"><a href="/Performance/Info/" class="nav-link">性能优化</a></div><div class="nav-item"><a href="/Recommend/" class="nav-link">推荐</a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/bingbing.jpg"> <div class="blogger-info"><h3>石怜安</h3> <span>在线找大长腿小姐姐</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><a href="/FrontEnd/" class="nav-link">前端知识库</a></div><div class="nav-item"><a href="/BackEnd/" class="nav-link">后端知识库</a></div><div class="nav-item"><a href="/DesignPattern/" class="nav-link">设计模式</a></div><div class="nav-item"><a href="/Algorithm/Dichotomy/" class="nav-link">常用算法</a></div><div class="nav-item"><a href="/Git/" class="nav-link">Git</a></div><div class="nav-item"><a href="/Server/" class="nav-link">服务器</a></div><div class="nav-item"><a href="/Performance/Info/" class="nav-link">性能优化</a></div><div class="nav-item"><a href="/Recommend/" class="nav-link">推荐</a></div> <!----></nav>  <!----> </aside> <div><main class="page"><div class="theme-vdoing-wrapper bg-style-6"><div class="articleInfo-wrap" data-v-1baff76c><div class="articleInfo" data-v-1baff76c><ul class="breadcrumbs" data-v-1baff76c><li data-v-1baff76c><a href="/" title="首页" class="iconfont icon-home router-link-active" data-v-1baff76c></a></li> <li data-v-1baff76c><a href="/categories/?category=FrontEnd" title="分类" data-v-1baff76c>FrontEnd</a></li><li data-v-1baff76c><a href="/categories/?category=Package" title="分类" data-v-1baff76c>Package</a></li><li data-v-1baff76c><a href="/categories/?category=Storage" title="分类" data-v-1baff76c>Storage</a></li></ul> <div class="info" data-v-1baff76c><div title="作者" class="author iconfont icon-touxiang" data-v-1baff76c><a href="404" target="_blank" title="作者" class="beLink" data-v-1baff76c>JSH</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-1baff76c><a href="javascript:;" data-v-1baff76c>2022-06-13</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="/bingbing.jpg">Storage<!----></h1>  <div class="theme-vdoing-content content__default"><p>很多人在用 localStorage 或 sessionStorage 的时候喜欢直接用明文存储，直接将信息暴露在浏览器中，</p> <p>虽然一般场景下都能应付得了且简单粗暴，但特殊需求情况下，比如设置定时功能，就不能实现。</p> <p>就需要对其进行二次封装，为了在使用上增加些安全感，那加密也必然是少不了的了。</p> <p>为方便项目使用，特对常规操作进行封装。</p> <h2 id="设计"><a href="#设计" class="header-anchor">#</a> 设计</h2> <div class="custom-block danger"><p class="custom-block-title">警告</p> <p>封装之前先梳理下所需功能，并要做成什么样，采用什么样的规范，部分主要代码片段是以 localStorage作为示例。</p></div> <ul><li>区分存储类型 type</li> <li>自定义名称前缀 prefix</li> <li>支持设置过期时间 expire</li> <li>支持加密可选，开发环境下未方便调试可关闭加密</li> <li>支持数据加密 这里采用 crypto-js 加密 也可使用其他方式</li> <li>判断是否支持 Storage isSupportStorage</li> <li>设置 setStorage</li> <li>获取 getStorage</li> <li>是否存在 hasStorage</li> <li>获取所有key getStorageKeys</li> <li>根据索引获取key getStorageForIndex</li> <li>获取localStorage长度 getStorageLength</li> <li>获取全部 getAllStorage</li> <li>删除 removeStorage</li> <li>清空 clearStorage</li></ul> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">//定义参数 类型 window.localStorage, window.sessionStorage,</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
  <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'localStorage'</span><span class="token punctuation">,</span> <span class="token comment">// 本地存储类型 localStorage/sessionStorage</span>
  <span class="token literal-property property">prefix</span><span class="token operator">:</span> <span class="token string">'JSH_0.0.1'</span><span class="token punctuation">,</span> <span class="token comment">// 名称前缀 建议：项目名 + 项目版本</span>
  <span class="token literal-property property">expire</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//过期时间 单位：秒</span>
  <span class="token literal-property property">isEncrypt</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 默认加密 为了调试方便, 开发过程中可以不加密</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="设置-setstorage"><a href="#设置-setstorage" class="header-anchor">#</a> 设置 setStorage</h3> <div class="custom-block danger"><p class="custom-block-title">警告</p> <p>Storage 本身是不支持过期时间设置的，要支持设置过期时间，可以效仿 Cookie 的做法，setStorage(key,value,expire) 方法，接收三个参数，第三个参数就是设置过期时间的，用相对时间，单位秒，要对所传参数进行类型检查。</p> <p>可以设置统一的过期时间，也可以对单个值得过期时间进行单独配置。两种方式按需配置。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">setStorage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span>value<span class="token punctuation">,</span>expire<span class="token operator">=</span><span class="token number">0</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">===</span> <span class="token string">''</span> <span class="token operator">||</span> value <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> value <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>expire<span class="token punctuation">)</span> <span class="token operator">||</span> expire <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Expire must be a number&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  expire <span class="token operator">=</span> <span class="token punctuation">(</span>expire<span class="token operator">?</span>expire<span class="token operator">:</span>config<span class="token punctuation">.</span>expire<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">60000</span><span class="token punctuation">;</span>
  <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">value</span><span class="token operator">:</span> value<span class="token punctuation">,</span> <span class="token comment">// 存储值</span>
      <span class="token literal-property property">time</span><span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//存值时间戳</span>
      <span class="token literal-property property">expire</span><span class="token operator">:</span> expire <span class="token comment">// 过期时间</span>
  <span class="token punctuation">}</span>

  window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="获取-getstorage"><a href="#获取-getstorage" class="header-anchor">#</a> 获取 getStorage</h3> <div class="custom-block danger"><p class="custom-block-title">警告</p> <p>首先要对 key 是否存在进行判断，防止获取不存在的值而报错。对获取方法进一步扩展，只要在有效期内获取 Storage 值，就对过期时间进行续期，如果过期则直接删除该值。并返回 null</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getStorage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// key 不存在判断</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'null'</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>

  <span class="token comment">// 优化 持续使用中续期</span>
  <span class="token keyword">const</span> storage <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">let</span> nowTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 过期删除</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>storage<span class="token punctuation">.</span>expire <span class="token operator">&amp;&amp;</span> config<span class="token punctuation">.</span>expire<span class="token operator">*</span><span class="token number">6000</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>nowTime <span class="token operator">-</span> storage<span class="token punctuation">.</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">removeStorage</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
      <span class="token comment">// 未过期期间被调用 则自动续期 进行保活</span>
      <span class="token function">setStorage</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span>storage<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> storage<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="获取所有值"><a href="#获取所有值" class="header-anchor">#</a> 获取所有值</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getAllStorage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">let</span> len <span class="token operator">=</span> window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token comment">// 获取长度</span>
  <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 定义数据集</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 获取key 索引从0开始</span>
      <span class="token keyword">let</span> getKey <span class="token operator">=</span> window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
      <span class="token comment">// 获取key对应的值</span>
      <span class="token keyword">let</span> getVal <span class="token operator">=</span> window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>getKey<span class="token punctuation">)</span>
      <span class="token comment">// 放进数组</span>
      arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token string-property property">'key'</span><span class="token operator">:</span> getKey<span class="token punctuation">,</span> <span class="token string-property property">'val'</span><span class="token operator">:</span> getVal<span class="token punctuation">,</span> <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">return</span> arr
<span class="token punctuation">}</span>
</code></pre></div><h3 id="删除-removestorage"><a href="#删除-removestorage" class="header-anchor">#</a> 删除 removeStorage</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 名称前自动添加前缀</span>
<span class="token keyword">const</span> <span class="token function-variable function">autoAddPrefix</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> prefix <span class="token operator">=</span> config<span class="token punctuation">.</span>prefix <span class="token operator">?</span> config<span class="token punctuation">.</span>prefix <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span>  prefix <span class="token operator">+</span> key<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 删除 removeStorage</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">removeStorage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token function">autoAddPrefix</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="清空-clearstorage"><a href="#清空-clearstorage" class="header-anchor">#</a> 清空 clearStorage</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">clearStorage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="加密、解密"><a href="#加密、解密" class="header-anchor">#</a> 加密、解密</h3> <div class="custom-block danger"><p class="custom-block-title">警告</p> <p>加密采用的是 crypto-js</p></div> <div class="language-shell script extra-class"><pre class="language-shell"><code>// 安装crypto-js
<span class="token function">npm</span> <span class="token function">install</span> crypto-js

// 引入 crypto-js 有以下两种方式
<span class="token function">import</span> CryptoJS from <span class="token string">&quot;crypto-js&quot;</span><span class="token punctuation">;</span>
// 或者
const CryptoJS <span class="token operator">=</span> require<span class="token punctuation">(</span><span class="token string">&quot;crypto-js&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block danger"><p class="custom-block-title">警告</p> <p>对 crypto-js 设置密钥和密钥偏移量，可以采用将一个私钥经 MD5 加密生成16位密钥获得。</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 十六位十六进制数作为密钥</span>
<span class="token keyword">const</span> <span class="token constant">SECRET_KEY</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;3333e6e143439161&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 十六位十六进制数作为密钥偏移量</span>
<span class="token keyword">const</span> <span class="token constant">SECRET_IV</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;e3bbe7e3ba84431a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><div class="custom-block danger"><p class="custom-block-title">警告</p> <p>对加密方法进行封装</p></div> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">/**
 * 加密方法
 * @param data
 * @returns {string}
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> data <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">try</span> <span class="token punctuation">{</span>
      data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;encrypt error:&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span>
  <span class="token keyword">const</span> dataHex <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> encrypted <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span><span class="token constant">AES</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>dataHex<span class="token punctuation">,</span> <span class="token constant">SECRET_KEY</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">iv</span><span class="token operator">:</span> <span class="token constant">SECRET_IV</span><span class="token punctuation">,</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">CBC</span><span class="token punctuation">,</span>
    <span class="token literal-property property">padding</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Pkcs7
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> encrypted<span class="token punctuation">.</span>ciphertext<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 解密方法
 * @param data
 * @returns {string}
 */</span>
<span class="token keyword">export</span> <span class="token keyword">function</span> <span class="token function">decrypt</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> encryptedHexStr <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Hex<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> str <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Base64<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>encryptedHexStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> decrypt <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span><span class="token constant">AES</span><span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token constant">SECRET_KEY</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">iv</span><span class="token operator">:</span> <span class="token constant">SECRET_IV</span><span class="token punctuation">,</span>
    <span class="token literal-property property">mode</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">CBC</span><span class="token punctuation">,</span>
    <span class="token literal-property property">padding</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Pkcs7
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> decryptedStr <span class="token operator">=</span> decrypt<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> decryptedStr<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>在存储数据及获取数据中进行使用：</p> <p>这里我们主要看下进行加密和解密部分，部分方法在下面代码段中并未展示，<code>请注意，不能直接运行</code>。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'localStorage'</span><span class="token punctuation">,</span> <span class="token comment">// 本地存储类型 sessionStorage</span>
    <span class="token literal-property property">prefix</span><span class="token operator">:</span> <span class="token string">'JSH_0.0.1'</span><span class="token punctuation">,</span> <span class="token comment">// 名称前缀 建议：项目名 + 项目版本</span>
    <span class="token literal-property property">expire</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//过期时间 单位：秒</span>
    <span class="token literal-property property">isEncrypt</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 默认加密 为了调试方便, 开发过程中可以不加密</span>
<span class="token punctuation">}</span>

<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">setStorage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> expire <span class="token operator">=</span> <span class="token number">0</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">===</span> <span class="token string">''</span> <span class="token operator">||</span> value <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> value <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>expire<span class="token punctuation">)</span> <span class="token operator">||</span> expire <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Expire must be a number&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    expire <span class="token operator">=</span> <span class="token punctuation">(</span>expire <span class="token operator">?</span> expire <span class="token operator">:</span> config<span class="token punctuation">.</span>expire<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> value<span class="token punctuation">,</span> <span class="token comment">// 存储值</span>
        <span class="token literal-property property">time</span><span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//存值时间戳</span>
        <span class="token literal-property property">expire</span><span class="token operator">:</span> expire <span class="token comment">// 过期时间</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 对存储数据进行加密 加密为可选配置</span>
    <span class="token keyword">const</span> encryptString <span class="token operator">=</span> config<span class="token punctuation">.</span>isEncrypt <span class="token operator">?</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token function">autoAddPrefix</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> encryptString<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>


<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getStorage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    key <span class="token operator">=</span> <span class="token function">autoAddPrefix</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// key 不存在判断</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'null'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 对存储数据进行解密</span>
    <span class="token keyword">const</span> storage <span class="token operator">=</span> config<span class="token punctuation">.</span>isEncrypt <span class="token operator">?</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token function">decrypt</span><span class="token punctuation">(</span>window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> nowTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token comment">// 过期删除</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>storage<span class="token punctuation">.</span>expire <span class="token operator">&amp;&amp;</span> config<span class="token punctuation">.</span>expire <span class="token operator">*</span> <span class="token number">6000</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>nowTime <span class="token operator">-</span> storage<span class="token punctuation">.</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">removeStorage</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">//  持续使用时会自动续期</span>
        <span class="token function">setStorage</span><span class="token punctuation">(</span><span class="token function">autoRemovePrefix</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> storage<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> storage<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h3 id="使用"><a href="#使用" class="header-anchor">#</a> 使用</h3> <p>使用的时候你可以通过 import 按需引入，也可以挂载到全局上使用，一般建议少用全局方式或全局变量，为后来接手项目继续开发维护的人，追查代码留条便捷之路！不要为了封装而封装，尽可能基于项目需求和后续的通用，以及使用上的便捷。比如获取全部存储变量，如果你项目上都未曾用到过，倒不如删减掉，留着过年也不见得有多香，不如为减小体积做点贡献！</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>isSupportStorage<span class="token punctuation">,</span> hasStorage<span class="token punctuation">,</span> setStorage<span class="token punctuation">,</span>getStorage<span class="token punctuation">,</span>getStorageKeys<span class="token punctuation">,</span>getStorageForIndex<span class="token punctuation">,</span>getStorageLength<span class="token punctuation">,</span>removeStorage<span class="token punctuation">,</span>getStorageAll<span class="token punctuation">,</span>clearStorage<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'@/utils/storage'</span>
</code></pre></div><h3 id="完整代码"><a href="#完整代码" class="header-anchor">#</a> 完整代码</h3> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> CryptoJS <span class="token keyword">from</span> <span class="token string">'crypto-js'</span><span class="token punctuation">;</span>

<span class="token comment">// 十六位十六进制数作为密钥</span>
<span class="token keyword">const</span> <span class="token constant">SECRET_KEY</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;3333e6e143439161&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 十六位十六进制数作为密钥偏移量</span>
<span class="token keyword">const</span> <span class="token constant">SECRET_IV</span> <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token string">&quot;e3bbe7e3ba84431a&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token comment">// 类型 window.localStorage,window.sessionStorage,</span>
<span class="token keyword">const</span> config <span class="token operator">=</span> <span class="token punctuation">{</span>
    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">'localStorage'</span><span class="token punctuation">,</span> <span class="token comment">// 本地存储类型 sessionStorage</span>
    <span class="token literal-property property">prefix</span><span class="token operator">:</span> <span class="token string">'JSH_0.0.1'</span><span class="token punctuation">,</span> <span class="token comment">// 名称前缀 建议：项目名 + 项目版本</span>
    <span class="token literal-property property">expire</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">//过期时间 单位：秒</span>
    <span class="token literal-property property">isEncrypt</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token comment">// 默认加密 为了调试方便, 开发过程中可以不加密</span>
<span class="token punctuation">}</span>

<span class="token comment">// 判断是否支持 Storage</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">isSupportStorage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> <span class="token punctuation">(</span>Storage<span class="token punctuation">)</span> <span class="token operator">!==</span> <span class="token string">&quot;undefined&quot;</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span>
<span class="token punctuation">}</span>

<span class="token comment">// 设置 setStorage</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">setStorage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key<span class="token punctuation">,</span> value<span class="token punctuation">,</span> expire <span class="token operator">=</span> <span class="token number">0</span></span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>value <span class="token operator">===</span> <span class="token string">''</span> <span class="token operator">||</span> value <span class="token operator">===</span> <span class="token keyword">null</span> <span class="token operator">||</span> value <span class="token operator">===</span> <span class="token keyword">undefined</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        value <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">isNaN</span><span class="token punctuation">(</span>expire<span class="token punctuation">)</span> <span class="token operator">||</span> expire <span class="token operator">&lt;</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Error</span><span class="token punctuation">(</span><span class="token string">&quot;Expire must be a number&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    expire <span class="token operator">=</span> <span class="token punctuation">(</span>expire <span class="token operator">?</span> expire <span class="token operator">:</span> config<span class="token punctuation">.</span>expire<span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">1000</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> data <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">value</span><span class="token operator">:</span> value<span class="token punctuation">,</span> <span class="token comment">// 存储值</span>
        <span class="token literal-property property">time</span><span class="token operator">:</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment">//存值时间戳</span>
        <span class="token literal-property property">expire</span><span class="token operator">:</span> expire <span class="token comment">// 过期时间</span>
    <span class="token punctuation">}</span>
    
    <span class="token keyword">const</span> encryptString <span class="token operator">=</span> config<span class="token punctuation">.</span>isEncrypt 
    <span class="token operator">?</span> <span class="token function">encrypt</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">setItem</span><span class="token punctuation">(</span><span class="token function">autoAddPrefix</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> encryptString<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 获取 getStorage</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getStorage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    key <span class="token operator">=</span> <span class="token function">autoAddPrefix</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// key 不存在判断</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token string">'null'</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>

    <span class="token comment">// 优化 持续使用中续期</span>
    <span class="token keyword">const</span> storage <span class="token operator">=</span> config<span class="token punctuation">.</span>isEncrypt 
    <span class="token operator">?</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span><span class="token function">decrypt</span><span class="token punctuation">(</span>window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    <span class="token operator">:</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
    <span class="token keyword">let</span> nowTime <span class="token operator">=</span> Date<span class="token punctuation">.</span><span class="token function">now</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">// 过期删除</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>storage<span class="token punctuation">.</span>expire <span class="token operator">&amp;&amp;</span> config<span class="token punctuation">.</span>expire <span class="token operator">*</span> <span class="token number">6000</span> <span class="token operator">&lt;</span> <span class="token punctuation">(</span>nowTime <span class="token operator">-</span> storage<span class="token punctuation">.</span>time<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token function">removeStorage</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
        <span class="token comment">// 未过期期间被调用 则自动续期 进行保活</span>
        <span class="token function">setStorage</span><span class="token punctuation">(</span><span class="token function">autoRemovePrefix</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> storage<span class="token punctuation">.</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> storage<span class="token punctuation">.</span>value<span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

<span class="token comment">// 是否存在 hasStorage</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">hasStorage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    key <span class="token operator">=</span> <span class="token function">autoAddPrefix</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token function">getStorageAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">filter</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">item</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token keyword">return</span> item<span class="token punctuation">.</span>key <span class="token operator">===</span> key<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">return</span> arr<span class="token punctuation">.</span>length <span class="token operator">?</span> <span class="token boolean">true</span> <span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 获取所有key</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getStorageKeys</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> items <span class="token operator">=</span> <span class="token function">getStorageAll</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">let</span> keys <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> index <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> index <span class="token operator">&lt;</span> items<span class="token punctuation">.</span>length<span class="token punctuation">;</span> index<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        keys<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>items<span class="token punctuation">[</span>index<span class="token punctuation">]</span><span class="token punctuation">.</span>key<span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> keys
<span class="token punctuation">}</span>

<span class="token comment">// 根据索引获取key</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getStorageForIndex</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">index</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token comment">// 获取localStorage长度</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getStorageLength</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span>length
<span class="token punctuation">}</span>

<span class="token comment">// 获取全部 getAllStorage</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">getStorageAll</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">let</span> len <span class="token operator">=</span> window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span>length <span class="token comment">// 获取长度</span>
    <span class="token keyword">let</span> arr <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Array</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment">// 定义数据集</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token comment">// 获取key 索引从0开始</span>
        <span class="token keyword">let</span> getKey <span class="token operator">=</span> window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">key</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
        <span class="token comment">// 获取key对应的值</span>
        <span class="token keyword">let</span> getVal <span class="token operator">=</span> window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">getItem</span><span class="token punctuation">(</span>getKey<span class="token punctuation">)</span>
        <span class="token comment">// 放进数组</span>
        arr<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token string-property property">'key'</span><span class="token operator">:</span> getKey<span class="token punctuation">,</span> <span class="token string-property property">'val'</span><span class="token operator">:</span> getVal<span class="token punctuation">,</span><span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> arr
<span class="token punctuation">}</span>

<span class="token comment">// 删除 removeStorage</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">removeStorage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">removeItem</span><span class="token punctuation">(</span><span class="token function">autoAddPrefix</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 清空 clearStorage</span>
<span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">clearStorage</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    window<span class="token punctuation">[</span>config<span class="token punctuation">.</span>type<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">clear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 名称前自动添加前缀</span>
<span class="token keyword">const</span> <span class="token function-variable function">autoAddPrefix</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> prefix <span class="token operator">=</span> config<span class="token punctuation">.</span>prefix <span class="token operator">?</span> config<span class="token punctuation">.</span>prefix <span class="token operator">+</span> <span class="token string">'_'</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span>  prefix <span class="token operator">+</span> key<span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 移除已添加的前缀</span>
<span class="token keyword">const</span> <span class="token function-variable function">autoRemovePrefix</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">key</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> len <span class="token operator">=</span> config<span class="token punctuation">.</span>prefix <span class="token operator">?</span> config<span class="token punctuation">.</span>prefix<span class="token punctuation">.</span>length<span class="token operator">+</span><span class="token number">1</span> <span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> key<span class="token punctuation">.</span><span class="token function">substr</span><span class="token punctuation">(</span>len<span class="token punctuation">)</span>
    <span class="token comment">// const prefix = config.prefix ? config.prefix + '_' : '';</span>
    <span class="token comment">// return  prefix + key;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 加密方法
 * @param data
 * @returns {string}
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">encrypt</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">typeof</span> data <span class="token operator">===</span> <span class="token string">&quot;object&quot;</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            data <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;encrypt error:&quot;</span><span class="token punctuation">,</span> error<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">const</span> dataHex <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> encrypted <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span><span class="token constant">AES</span><span class="token punctuation">.</span><span class="token function">encrypt</span><span class="token punctuation">(</span>dataHex<span class="token punctuation">,</span> <span class="token constant">SECRET_KEY</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">iv</span><span class="token operator">:</span> <span class="token constant">SECRET_IV</span><span class="token punctuation">,</span>
        <span class="token literal-property property">mode</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">CBC</span><span class="token punctuation">,</span>
        <span class="token literal-property property">padding</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Pkcs7
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> encrypted<span class="token punctuation">.</span>ciphertext<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">/**
 * 解密方法
 * @param data
 * @returns {string}
 */</span>
<span class="token keyword">const</span> <span class="token function-variable function">decrypt</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> encryptedHexStr <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Hex<span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> str <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Base64<span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>encryptedHexStr<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> decrypt <span class="token operator">=</span> CryptoJS<span class="token punctuation">.</span><span class="token constant">AES</span><span class="token punctuation">.</span><span class="token function">decrypt</span><span class="token punctuation">(</span>str<span class="token punctuation">,</span> <span class="token constant">SECRET_KEY</span><span class="token punctuation">,</span> <span class="token punctuation">{</span>
        <span class="token literal-property property">iv</span><span class="token operator">:</span> <span class="token constant">SECRET_IV</span><span class="token punctuation">,</span>
        <span class="token literal-property property">mode</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>mode<span class="token punctuation">.</span><span class="token constant">CBC</span><span class="token punctuation">,</span>
        <span class="token literal-property property">padding</span><span class="token operator">:</span> CryptoJS<span class="token punctuation">.</span>pad<span class="token punctuation">.</span>Pkcs7
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">const</span> decryptedStr <span class="token operator">=</span> decrypt<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span>CryptoJS<span class="token punctuation">.</span>enc<span class="token punctuation">.</span>Utf8<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> decryptedStr<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></div></div>  <div class="page-edit"><!----> <div class="tags"><a href="/tags/?tag=%E7%BC%93%E5%AD%98" title="标签">#缓存</a></div> <div class="last-updated"><span class="prefix">最近更新时间:</span> <span class="time">6/13/2022, 5:21:58 PM</span></div></div> <div class="page-nav-wapper"><!----> <!----></div></div> <div class="article-list"><div class="article-title"><a href="/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/Vue3/ToolFunction/"><div>
            VUE3工具函数源码解析
            <!----></div></a> <span class="date">07-11</span></dt></dl><dl><dd>02</dd> <dt><a href="/Performance/info/"><div>
            浅谈性能优化
            <!----></div></a> <span class="date">06-30</span></dt></dl><dl><dd>03</dd> <dt><a href="/React/Hooks/"><div>
            浅谈12个Hooks
            <!----></div></a> <span class="date">06-27</span></dt></dl> <dl><dd></dd> <dt><a href="/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="String" title="1051131737" target="_blank" class="iconfont icon-QQ"></a><a href="String" title="1051131737@qq.com" target="_blank" class="iconfont icon-youjian"></a><a href="String" title="jsh1051131737" target="_blank" class="iconfont icon-weixin"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2021-2022
    <span>JSH</span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div id="pwa-install"><!----> <div id="install-modal-wrapper" style="display:none;"><div class="background"></div> <div class="install-modal"><div class="header"><button aria-label="Close" class="close-button"><svg width="23" height="22" xmlns="http://www.w3.org/2000/svg" class="icon close-icon"><path fill-rule="evenodd" clip-rule="evenodd" d="M1.12.358a1.224 1.224 0 011.729 0l8.92 8.914L20.686.358a1.224 1.224 0 011.73 1.728L13.497 11l8.92 8.913a1.222 1.222 0 11-1.73 1.729l-8.919-8.913-8.92 8.913a1.224 1.224 0 01-1.729-1.729L10.04 11l-8.92-8.914a1.222 1.222 0 010-1.728z" fill="currentColor"></path></svg></button> <div class="logo"><!----> <div class="title"><h1></h1> <p class="desc">This app can be installed on your PC or mobile device.  This will allow this web app to look and behave like any other installed app.  You will find it in your app lists and be able to pin it to your home screen, start menus or task bars.  This installed web app will also be able to safely interact with other apps and your operating system. </p></div></div></div> <div class="content"><div class="highlight"><!----> <!----></div> <div class="description"><h3>Description</h3> <p></p></div></div> <div class="button-wrapper"><button class="install-button">
        Install <span></span></button> <button class="cancel-button">
        Cancel
      </button></div></div></div></div><!----><!----><div></div><div></div></div></div>
    <script src="/assets/js/app.e55f4abd.js" defer></script><script src="/assets/js/3.bc0c2498.js" defer></script><script src="/assets/js/60.071b43a3.js" defer></script><script src="/assets/js/22.ced87b4d.js" defer></script><script src="/assets/js/9.e2c20ecd.js" defer></script>
  </body>
</html>
